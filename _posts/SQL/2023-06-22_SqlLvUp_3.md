---
layout: post
title: SQL 레벨업 - 3장
tags: [SQL, SqlLvUp, UF]
permalink: /docs/SQL/SqlLvUp_3
date: 2023-06-22 23:17:00
---
# SQL의 조건 분기
## UNION을 사용한 쓸데없이 긴 표현
```sql
SELECT item_name, year, price_tax_ex AS price
FROM items
WHERE year <= 2001
UNION ALL
SELECT item_name, year, price_tax_in AS price
FROM items
WHERE year >= 2002
```
- 2회의 테이블 풀 스캔이 발생
- 위와 같은 UNION을 이용한 조건 분기는 여러 개의 SELECT 문을 실행하는 실행 계획으로 해석되기 때문에 I/O 비용이 크게 증가
- 정확한 판단 없이 SELECT  구문을 여러 번 사용할 경우 SQL 성능이 저하됨
### WHERE 구에서 조건 분기를 하는 사람은 초보자
- WHERE 구에서 조건 분기를 하지 않고 SELECT 구에서 CASE 식을 사용하여 조건 분기
```sql
SELECT item_name, year,
       CASE WHEN year <= 2001 THEN price_tax_ex
            WHEN year >= 2002 THEN price_tax_in END AS price
  FROM items;
```
## 집계와 조건 분기
## 그래도 UNION이 필요한 경우
## 절차 지향형과 선언형