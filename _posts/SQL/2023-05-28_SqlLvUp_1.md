---
layout: post
title: SQL 레벨업 - 1장. DBMS 아키텍쳐
tags: [SQL, SqlLvUp, UF]
permalink: /docs/SQL/SqlLvUp_1
date: 2023-05-28 23:55:00
---
# DBMS 아키텍쳐
## DBMS 아키텍쳐 개요

![DBMS 아키텍처 개요](https://github.com/melodist/MELTNET/assets/52024566/e4fdccec-0429-4053-86b4-c93ac9e8904b)

1. 쿼리 평가 엔진
  - 사용자가 입력한 SQL 구문을 분석하고 실행 계획을 결정
  - 실행 계획(Explain Plan): 어떤 순서로 기억장치에 데이터를 접근할지 결정하는 계획
  - 쿼리(query): SELECT 구문 또는 SQL 구문 전체를 의미

2. 버퍼 매니저
  - 특별한 용도로 사용되는 버퍼 영역을 관리
  - 디스크 용량 매니저와 연동

3. 디스크 용량 매니저
  - 데이터 I/O 제어

4. 트랜잭션 매니저와 락 매니저
  - 트랜잭션의 정합성을 유지
  - 필요할 경우 데이터에 락을 걸어 요청을 대기시킴
  
5. 리커버리 매니저
  - DBMS에 장애가 발생했을 때에 대비하여 데이터를 정기적으로 백업하고 문제가 일어났을 때 복구

## DBMS와 버퍼
### 기억장치의 계층 (memory hierarchy)
![memory hierarchy](https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/ComputerMemoryHierarchy.svg/1200px-ComputerMemoryHierarchy.svg.png)

- 기억장치는 기억 비용, 데이터를 저장하는 데에 드는 비용에 따라 구분
- 아래로 내려갈수록 기억 비용은 적어지지만 데이터 접근 속도는 떨어짐

### DBMS와 기억장치의 관계
- 하드디스크(HDD)
  - DBMS가 주로 데이터를 저장하는 매체, 범용성이 높음
- 메모리
  - SQL 구문의 실행 속도를 높이기 위해 자주 접근하는 데이터를 메모리에 적재 → buffer 또는 cache
  - 버퍼에 데이터를 어떻게, 어느 정도의 기간 동안 올릴 지를 관리하는 것이 버퍼 매니저

### 메모리 위에 있는 두 개의 버퍼
- 데이터 캐시
  - 디스크에 있는 데이터의 일부를 메모리에 유지
- 로그 버퍼
  - DBMS는 갱신과 관련된 SQL 구문을 사용자로부터 받으면 곧바로 저장소에 있는 데이터를 변경하지 않고 로그 버퍼에 변경 정보를 기록
  - 저장소 변경이 끝날 때까지 사용자가 기다리지 않게 하고 내부적으로 데이터를 처리 (비동기)

### 메모리의 성질이 초래하는 트레이드오프
- 일반적으로 사용하는 메모리는 전원 공급이 없을 경우 데이터가 사라짐
- 장애가 발생했을 때 로그 버퍼 위에 존재하는 데이터가 저장소에 반영되기 전에 사라지면 데이터의 정합성이 깨짐
- 이를 회피하고자 DBMS는 커밋 시점에 반드시 갱신 정보를 영속적인 저장소에 존재하는 로그 파일에 작성
- 커밋 때는 반드시 디스크에 동기 접근이 일어나므로 지연 발생 가능

## DBMS와 실행 계획
## 실행 계획이 SQL 구문의 성능을 결정
## 실행 계획의 중요성