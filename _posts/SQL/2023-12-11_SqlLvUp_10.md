---
layout: post
title: SQL 레벨업 - 10장. 인덱스 사용
tags: [SQL, SqlLvUp, UF]
permalink: /docs/SQL/SqlLvUp_10
date: 2023-12-11 22:48:00
---
# 인덱스 사용
## 인덱스와 B-tree
### 만능형: B-tree
- 데이터를 트리 구조로 저장하는 형태
- 대부분의 데이터베이스에서는 트리의 리프 노드에만 키값을 저장하는 B+tree 사용
- 루트와 리프의 거리를 가능한 일정하게 유지하므로 검색 성능이 안정적
### 기타 인덱스
- 비트맵 인덱스
  - 데이터를 비트 플래그로 변환
  - 카디널리티가 낮은 필드에 유효
  - 갱신할 때 오버헤드가 크므로 BI/DWH 용도로 사용
- 해시 인덱스
  - 키를 해시 분산해서 등가 검색을 고속으로 실행
  - 등가 검색 외에는 효과가 거의 없고 범위 검색을 할 수 없음
  - PostgreSQL, Oracle 등 일부 DB만 지원
## 인덱스를 잘 활용하려면
### 카디널리티와 선택률
- 카디널리티: 값의 균형을 나타냄
  - 카디널리티가 높은 필드는 모든 레코드에 다른 값이 들어가 있는 유일 키 필드
  - 카디널리티가 낮은 필드는 모든 레코드에 같은 값이 들어가 있는 필드
- 선택률: 특정 필드 값을 지정했을 때 테이블 전체에서 몇 개의 레코드가 선택되는지를 나타냄
### 인덱스를 사용하는 것이 좋은지 판단하려면
- 인덱스를 작성하는 필드 집합의 조건
  - 카디널리티가 높음: 값이 평균치에서 많이 흩어져있음
  - 선택률이 낮음: 한 번의 선택으로 적은 갯수의 레코드가 선택됨, 대략 5~10% 이하가 기준
## 인덱스로 성능 향상이 어려운 경우
## 인덱스를 사용할 수 없는 경우 대처법